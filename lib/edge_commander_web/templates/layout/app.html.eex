<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="description" content="Latest updates and statistic charts">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <%= Phoenix.HTML.Tag.csrf_meta_tag() %>
    <!--begin::Base Styles -->
    <link href="<%= static_path(@conn, "/css/semantic.min.css") %>" rel="stylesheet" type="text/css" />
    <link href="<%= static_path(@conn, "/assets/vendors/base/vendors.bundle.css") %>" rel="stylesheet" type="text/css" />
    <link href="<%= static_path(@conn, "/css/dataTables.semanticui.min.css") %>" rel="stylesheet" type="text/css" />
    <link href="<%= static_path(@conn, "/assets/demo/default/base/style.bundle.css") %>" rel="stylesheet" type="text/css" />
    <link href="<%= static_path(@conn, "/css/visavail.css") %>" rel="stylesheet" type="text/css" />
    <link href="<%= static_path(@conn, "/css/personal.css") %>" rel="stylesheet" type="text/css" />
    <!--end::Base Styles -->
    <link rel="shortcut icon" href="<%= static_path(@conn, "/assets/demo/default/media/img/logo/favicon.ico") %>" />
    <link rel="apple-touch-icon" sizes="57x57" href="<%= static_path(@conn, "/images/fav-icons/apple-icon-57x57.png") %>">
    <link rel="apple-touch-icon" sizes="60x60" href="<%= static_path(@conn, "/images/fav-icons/apple-icon-60x60.png") %>">
    <link rel="apple-touch-icon" sizes="72x72" href="<%= static_path(@conn, "/images/fav-icons/apple-icon-72x72.png") %>">
    <link rel="apple-touch-icon" sizes="76x76" href="<%= static_path(@conn, "/images/fav-icons/apple-icon-76x76.png") %>">
    <link rel="apple-touch-icon" sizes="114x114" href="<%= static_path(@conn, "/images/fav-icons/apple-icon-114x114.png") %>">
    <link rel="apple-touch-icon" sizes="120x120" href="<%= static_path(@conn, "/images/fav-icons/apple-icon-120x120.png") %>">
    <link rel="apple-touch-icon" sizes="144x144" href="<%= static_path(@conn, "/images/fav-icons/apple-icon-144x144.png") %>">
    <link rel="apple-touch-icon" sizes="152x152" href="<%= static_path(@conn, "/images/fav-icons/apple-icon-152x152.png") %>">
    <link rel="apple-touch-icon" sizes="180x180" href="<%= static_path(@conn, "/images/fav-icons/apple-icon-180x180.png") %>">
    <link rel="icon" type="image/png" sizes="192x192"  href="<%= static_path(@conn, "/images/fav-icons/android-icon-192x192.png") %>">
    <link rel="icon" type="image/png" sizes="32x32" href="<%= static_path(@conn, "/images/fav-icons/favicon-32x32.png") %>">
    <link rel="icon" type="image/png" sizes="96x96" href="<%= static_path(@conn, "/images/fav-icons/favicon-96x96.png") %>">
    <link rel="icon" type="image/png" sizes="16x16" href="<%= static_path(@conn, "/images/fav-icons/favicon-16x16.png") %>">
    <link rel="manifest" href="<%= static_path(@conn, "/images/fav-icons/manifest.json") %>">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="<%= static_path(@conn, "/images/fav-icons/ms-icon-144x144.png") %>">
    <meta name="theme-color" content="#ffffff">
    <title>EdgeCommander: Device Management & Monitoring Made Easy</title>
      <link rel="stylesheet" href="<%= static_path(@conn, "/css/app.css") %>">

  </head>

  <!--begin::Web font -->
  <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.16/webfont.js"></script>
  <script>
    WebFont.load({
      google: {"families":["Poppins:300,400,500,600,700","Roboto:300,400,500,600,700"]},
      active: function() {
        sessionStorage.fonts = true;
      }
    });
  </script>
  <!--end::Web font -->

  <main role="main" >
    <%= render @view_module, @view_template, assigns %>
  </main>

<!--begin::Base Scripts -->
<%= if @conn.request_path == "/" or @conn.request_path == "/users/sign_up" do %>
  <script src="<%= static_path(@conn, "/assets/vendors/base/vendors.bundle.js") %>" type="text/javascript"></script>
<%  end %>

<%= if @conn.request_path == "/sims" or @conn.request_path == "/sims_ajax" do %>
  <script src="<%= static_path(@conn, "/assets/demo/default/custom/components/datatables/base/data-local.js") %>"> type="text/javascript"></script>
  <link href="<%= static_path(@conn, "/css/intlTelInput.css") %>" rel="stylesheet" type="text/css" />
  <script src="<%= static_path(@conn, "/js/intlTelInput.js") %>" type="text/javascript"></script>
<%  end %>

<%= if String.starts_with?(@conn.request_path, "/sims/") or String.starts_with?(@conn.request_path, "/sims_ajax/") do %>
  <script src="<%= static_path(@conn, "/js/sim_graph_data.js") %>" type="text/javascript"></script>
  <script type="text/javascript">
    vm.autocompleteInputSms();
  </script>
<% end %>

<%= if @conn.request_path == "/api" or @conn.request_path == "/api_ajax" do %>
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700|Source+Code+Pro:300,600|Titillium+Web:400,600,700" rel="stylesheet">
  <link href="<%= static_path(@conn, "/swagger/swagger-ui.css") %>" rel="stylesheet" type="text/css" />
  <script src="<%= static_path(@conn, "/swagger/swagger-ui-bundle.js") %>" type="text/javascript"></script>
  <script src="<%= static_path(@conn, "/swagger/swagger-ui-standalone-preset.js") %>" type="text/javascript"></script>
  <script>
    var url = window.location.origin + '/swagger/swagger.json';
    var vm = new Vue({
      el: '#api_main',
      data: {},
      methods: {
        swagger_api: function(){
          const swagger_url = new URL(window.location);
          swagger_url.pathname = swagger_url.pathname.replace("index.html", "swagger.json");
          swagger_url.hash = "";
          const ui = SwaggerUIBundle({
            url:  url,
            dom_id: '#swagger-ui',
            deepLinking: false,
            presets: [
              SwaggerUIBundle.presets.apis,
              SwaggerUIStandalonePreset
            ],
            plugins: [
              SwaggerUIBundle.plugins.DownloadUrl
            ],
            layout: "StandaloneLayout"
          })
          window.ui = ui
        },
        resizeScreen: function(){
          $('#double-scroll').doubleScroll();
          var table_width = $("#swagger-ui").width();
          $(".doubleScroll-scroll").width(table_width);
        }
      }, // end of methods
      mounted(){
        this.resizeScreen();
        window.addEventListener('load', this.swagger_api);
        window.addEventListener('resize', this.resizeScreen);
      }
    });
  </script>
<%  end %>

<%= if @conn.request_path == "/status_report" or @conn.request_path == "/status_report_ajax"  do %>
  <script src="<%= static_path(@conn, "/assets/app/js/dashboard.js") %>" type="text/javascript"></script>
  <script src="<%= static_path(@conn, "/js/d3.min.js") %>"> type="text/javascript"></script>
  <script src="<%= static_path(@conn, "/js/visavail.js") %>"> type="text/javascript"></script>
  <script src="<%= static_path(@conn, "/js/statusreport.js") %>"> type="text/javascript"></script>
  <script type="text/javascript">
  $( document ).ready(function() {
    $(".range_inputs").css("display", "none");
    $('.ranges > ul > li:last-child').remove();
    $('.ranges > ul > li:last-child').remove();
    $('.ranges > ul > li:last-child').remove();
  });
  </script>
<%  end %>

<script type="text/javascript">
  function load_page(link){
    if(link.indexOf("/sims/") == 0){
      var arr = link.split('/');
      var string_one = arr[1];
      var string_two = arr[2];
      link_data = "/"+string_one+'_ajax' +"/" + string_two;
      if(string_two.indexOf('+') == -1){
        link = "/"+string_one +"/+" + string_two;
      }

    }else{
      link_data = link+'_ajax';
    }
    mApp.block("#remote_data", {
        overlayColor: "#000000",
        type: "loader",
        state: "success",
        message: "Please wait..."
    });
    $.get(link_data, function( data ) {
      window.history.pushState(null, null, link);
      $( "#remote_data" ).html( data );
      mApp.unblock("#remote_data")
      var pathname = document.location.href.match(/[^\/]+$/)[0];
      if(link.indexOf("/sims/") == 0){
        pathname = "sims";
      }
      $("li").removeClass(" m-menu__item--active");
      $("."+ pathname).addClass(" m-menu__item--active")
      $(".m-aside-left-overlay").remove();
      $("#m_aside_left").removeClass("m-aside-left--on");
      $("#m_aside_left_offcanvas_toggle").removeClass("m-brand__toggler--active");
      $("#body_pannel").removeClass("m-aside-left--on");
      if(link == '/api'){
        vm.swagger_api()
      }
    });
  }

  $(".menu_collapse").click(function(){
    $("#body_pannel").addClass("m-brand--minimize m-aside-left--minimize")
    $(".menu_expand").css("display", "block")
  });

  $(".menu_expand").click(function(){
    $("#body_pannel").removeClass("m-brand--minimize m-aside-left--minimize")
    $(".menu_expand").css("display", "none")
  });

   var counter = 1;
    $(window).on('popstate', function() {
        if(counter == 1){
            url = location.pathname
            load_page(url)
        }
        counter = counter + 1;
    });


</script>
<script src="<%= static_path(@conn, "/js/app.js") %>"></script>
</html>
